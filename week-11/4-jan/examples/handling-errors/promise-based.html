<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Handling errors - Promise based</title>
    <script type="module">
      /* We're now returning a promise. This let's the "outside world"
      become aware of when the image has loaded. */
      function loadImage(src, callback) {
        return new Promise((resolve) => {
          const img = document.createElement("img");
          img.src = src;

          img.addEventListener("load", () => {
            console.log("loaded!");
            /* We call resolve, which will resolve the promise. */
            resolve();
          });

          document.body.append(img);
        });
      }

      const promise = loadImage(
        "https://media.istockphoto.com/photos/feline-picture-id108226626?k=20&m=108226626&s=612x612&w=0&h=bDaWwxhcygjerdR71qQu8YFSXaDUIi_HUZV2AADg5L8="
      );

      /* This will be executed as soon as our image has loaded successfully. */
      promise.then(() => {
        const p = document.createElement("p");
        p.textContent = "The image loaded!";
        document.body.append(p);
      });

      console.log("After initiating loading of image!");
    </script>
  </head>
  <body></body>
</html>
